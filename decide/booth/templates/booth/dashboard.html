{% extends "booth/base.html" %}
{% load i18n static %}

{% block logout %}
<a class="btn btn-danger" href="{% url 'logout' %}">Cerrar Sesión</a>
{% endblock %}

{% block content %}
{% if no_censo %}
    <p>No has sido añadido al censo de alguna votación</p>
{% else %}
    <h2>Votaciones disponibles:</h2>
    {% for votacion in vot_dis %}
        <ul style="list-style-type:none;">
            <a href="{% url 'votacion' votacion.id %}"><li>{{votacion.name}}</li></a>
        </ul>    
    {% endfor %}
    {% if no_vot_dis %}
        <p>No tiene votaciones disponibles</p>
    {% endif %}
    <h2>Votaciones por meses del año:</h2>
    <div id="container1" style="width: 60%; display: inline-block;">
        <canvas id="vot_por_mes_chart"></canvas>
    </div>
    <h2>Votaciones de cada tipo</h2>
    <div id="container2" style="width: 60%; display: inline-block;">
        <canvas id="tipos_vot_chart"></canvas>
    </div>
{% endif %}
{% endblock %}

{% block extrabody %}

<script>
    var app = new Vue({
        delimiters: ['[[', ']]'],
        el: '#app-booth',
        data: {
            alertShow: false,
            alertMsg: "",
            alertLvl: "info",
            csspd: false,
            csstrit: false
        },
        methods: {
            change_css(v1,v2) {
                if (v1 & !v2) {
                    this.csspd = true;
                    this.csstrit = false;
                    document.body.style.backgroundColor = black;
                } else if (!v1 & v2) {
                    this.csspd = false;
                    this.csstrit = true;
                    document.body.style.backgroundColor = black;
                } else {
                    this.csspd = false;
                    this.csstrit = false;
                    document.body.style.backgroundColor = white;
                }
            },
            showAlert(lvl, msg) {
                this.alertLvl = lvl;
                this.alertMsg = msg;
                this.alertShow = true;
            }
        }
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script>

    var config1 = {
      type: 'bar',
      data: {
        datasets: [{
          data:{{votaciones_por_meses}},
          backgroundColor: '#007bff',
          label: 'Votaciones'
        }],
        labels: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre']
      },
      options: {
        responsive: true
      }
    };

    var config2 = {
      type: 'bar',
      data: {
        datasets: [{
          data:{{tipo_votaciones}},
          backgroundColor: '#007bff',
          label: 'Votaciones'
        }],
        labels: ['Única', 'Múltiple', 'Rango']
      },
      options: {
        responsive: true
      }
    };

    window.onload = function() {
      var ctx1 = document.getElementById('vot_por_mes_chart').getContext('2d');
      var ctx2 = document.getElementById('tipos_vot_chart').getContext('2d');
      window.myBar = new Chart(ctx1, config1);
      window.myBar = new Chart(ctx2, config2);
    };
  </script>
{% endblock %}