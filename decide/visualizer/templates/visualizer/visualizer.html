{% extends "base.html" %}
{% load i18n static %}

{% block extrahead %}
<link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css" />
<link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css" />
<link type="text/css" rel="stylesheet" href="{% static " booth/style.css" %}" />
{% endblock %}

{% block content %}
<div id="app-visualizer">
    <!-- Navbar -->
    <b-navbar type="dark" variant="secondary">
        <b-navbar-brand tag="h1">Decide</b-navbar-brand>
    </b-navbar>

    <div class="voting container">
        <h1>[[ voting.id ]] - [[ voting.name ]]</h1>

        <h2 v-if="!voting.start_date">Votaci贸n no comenzada</h2>
        <h2 v-else-if="!voting.end_date">Votaci贸n en curso</h2>
        <div v-else>
            <h2 class="heading">Resultados:</h2>

            <table class="table table-bordered table-striped">
                <thead>
                    <tr>
                        <th>Opci贸n</th>
                        <th>Puntuaci贸n</th>
                        <th>Votos</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="opt in voting.postproc" :key="opt.number">
                        <th>[[opt.option]]</th>
                        <td>[[opt.postproc]]</td>
                        <td class="text-muted">[[opt.votes]]</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <canvas id="myChart"></canvas>
    </div>
</div>
{% endblock %}

{% block extrabody %}
<!-- Vuejs -->
<script src="https://unpkg.com/vue"></script>
<script src="https://unpkg.com/babel-polyfill@latest/dist/polyfill.min.js"></script>
<script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>

<script>
    var voting = {{ voting| safe}};
    var app = new Vue({
        delimiters: ['[[', ']]'],
        el: '#app-visualizer',
        data: {
            voting: voting
        }
    })
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    var ctx = document.getElementById("myChart").getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
            datasets: [{
                label: 'Number of Votes',
                data: [12, 19, 3, 5, 2, 3],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255,99,132,1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });
</script>
</body>
{% endblock %}